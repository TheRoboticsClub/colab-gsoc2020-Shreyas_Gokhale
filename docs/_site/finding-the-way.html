<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="p:domain_verify" content="74b28158c46b8035f8f4a5ba032e51b2" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="GSoC 2020 | Shreyas Gokhale" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="GSoC 2020 | Shreyas Gokhale" /> <title> Finding the way - GSoC 2020 | Shreyas Gokhale </title> <link rel="alternate" href="http://localhost:4000/colab-gsoc2020-Shreyas_Gokhale/finding-the-way" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/colab-gsoc2020-Shreyas_Gokhale/finding-the-way" /> <meta name="description" content="Amazon warehouse exercise in ROS2" /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Finding the way | shreyasgokhale" /> <meta property="og:title" content="Finding the way | shreyasgokhale" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/colab-gsoc2020-Shreyas_Gokhale/finding-the-way" /> <meta property="og:description" content="Amazon warehouse exercise in ROS2" /> <meta property="og:image" content="http://localhost:4000/colab-gsoc2020-Shreyas_Gokhale/assets/img/ogp.png" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Finding the way | shreyasgokhale" /> <meta name="twitter:url" content="http://localhost:4000/colab-gsoc2020-Shreyas_Gokhale/finding-the-way" /> <meta name="twitter:site" content="@shreyasgokhale" /> <meta name="twitter:creator" content="@shreyasgokhale" /> <meta name="twitter:description" content="Amazon warehouse exercise in ROS2" /> <meta name="twitter:image" content="http://localhost:4000/colab-gsoc2020-Shreyas_Gokhale/assets/img/ogp.png" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/colab-gsoc2020-Shreyas_Gokhale/feed.xml" title="GSoC 2020 | Shreyas Gokhale" /> <link rel="apple-touch-icon" sizes="180x180" href="/colab-gsoc2020-Shreyas_Gokhale/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/colab-gsoc2020-Shreyas_Gokhale/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/colab-gsoc2020-Shreyas_Gokhale/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/colab-gsoc2020-Shreyas_Gokhale/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/colab-gsoc2020-Shreyas_Gokhale/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="ShreyasGokhale" /> <meta name="application-name" content="ShreyasGokhale" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/colab-gsoc2020-Shreyas_Gokhale/assets/css/style.css" /> </head> <body> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mood"> <svg class="mood-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mood-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"> <a class="menu-link" href="/colab-gsoc2020-Shreyas_Gokhale">home</a> <a class="menu-link" href="/colab-gsoc2020-Shreyas_Gokhale/about/">about author</a> <a class="menu-link" href="https://www.notion.so/shreyasgokhale/GSoC-JdeRobot-ff2c6cf65b3f4a488ca0af77e1daeff1" target="_blank" rel="noopener" >GSoC dashboard</a > <a class="menu-link" href="https://jderobot.github.io/" target="_blank" rel="noopener" >jderobot academy</a > <a class="menu-link" href="https://github.com/TheRoboticsClub/colab-gsoc2020-Shreyas_Gokhale" target="_blank" rel="noopener" >github repo</a > <a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/colab-gsoc2020-Shreyas_Gokhale/tags/#amazon-warehouse-robot">AMAZON-WAREHOUSE-ROBOT</a>, <a class="tag" href="/colab-gsoc2020-Shreyas_Gokhale/tags/#exercise">EXERCISE</a>, <a class="tag" href="/colab-gsoc2020-Shreyas_Gokhale/tags/#gazebo">GAZEBO</a>, <a class="tag" href="/colab-gsoc2020-Shreyas_Gokhale/tags/#ros2">ROS2</a>, <a class="tag" href="/colab-gsoc2020-Shreyas_Gokhale/tags/#nav2">NAV2</a>, <a class="tag" href="/colab-gsoc2020-Shreyas_Gokhale/tags/#week-9">WEEK-9</a> </span> </div> <h1 class="header-title" itemprop="headline">Finding the way</h1> <div class="post-meta"> <time datetime="2020-08-01T15:30:00+02:00" itemprop="datePublished"> Aug 01, 2020 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Shreyas Gokhale</span> </span> <time hidden datetime="" itemprop="dateModified"> Aug 01, 2020 </time> <span hidden itemprop="publisher" itemtype="Person">Shreyas Gokhale</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><blockquote> <p>Issues Pending:</p> <p><a href="https://github.com/JdeRobot/CustomRobots/issues/7">#7</a> WIP for ROS2 Amazon Robot model</p> </blockquote> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <blockquote> <p>Issues Pending:</p> <p><a href="https://github.com/JdeRobot/CustomRobots/issues/7">#7</a> WIP for ROS2 Amazon Robot model</p> </blockquote> <h1 id="week-9-blog"> <a href="#week-9-blog" class="anchor-head"></a> Week 9 blog </h1> <h2 id="navigation-2"> <a href="#navigation-2" class="anchor-head"></a> Navigation 2 </h2> <p>This week, we are now finally able to launch the exercise, complete with navigation2! It is the successor of the navigation stack in ROS1 for ROS2 and it is build completely from ground up. Navigation2 also uses Behavior trees instead of the FSMs in move_base and they are much more intuitive and modern way of handling navigation tasks.</p> <p>Navigation2 already has an up to date and extensive documentation and a really nicely written paper. But if you are a video person, I’d advise watching the minutes of ROS working group meeting to get it started quickly.</p> <div class="embed-container"> <iframe src="https://www.youtube.com/embed/-MzsEykCXoU" width="700" height="480" frameborder="0" allowfullscreen=""> </iframe> </div> <p>The objective of the exercise is to understand ROS2 actions, behaviour trees and navigation stack. In the end you will be able drive the robot around and interact with it using our Jderobot GUI.</p> <h3 id="ros-actions"> <a href="#ros-actions" class="anchor-head"></a> ROS Actions </h3> <p>Consider this scenario: You want to buy something, say a toothbrush, online. You find one which you like and now you want to order it. But you find out that the system wants you to go on the warehouse’s site and tell the admins that you need this particular item, then tell the packing station to pack it, then order delivery services to pick this package and then drop it at your doorstep, all by yourself. You will think that this is crazy as all you want is the package delivered and you really don’t care about the steps in between. Sure, you would <em>like</em> to have updates regarding the shipment, but the whole purpose of ordering online is not to deal with the stuff in-between. Well, this is exactly what ROS action does.</p> <p><img src="https://index.ros.org/doc/ros2/_images/Action-SingleActionClient.gif" alt="ROS2 actions" /></p> <p>Credits: <a href="https://index.ros.org/doc/ros2/Tutorials/Understanding-ROS2-Actions/">Actions Tutorial ROS2</a></p> <p>ROS actions provide an interface which abstracts long, complex task from the node. You can program an <em>“Action Server”</em> to accept requests of a task and return the result of the request once it is completed to the <em>“Action Client”</em>. Meanwhile, you can also get updates regarding your request. Action client can also cancel or update your goal for the task.</p> <p>In Navigation 2, action servers are used to communicate with the highest level BT navigator through a <code class="highlighter-rouge">NavigateToPose</code> action message. They are also used for the BT navigator to communicate with the subsequent smaller action servers to compute plans, control efforts, and recoveries. Each will have their own unique <code class="highlighter-rouge">.action</code> type in <code class="highlighter-rouge">nav2_msgs</code> package for interacting with the servers.</p> <p>For understanding it better, I’d definitely recommend the reader to have a look on the <a href="http://design.ros2.org/articles/actions.html">ROS2 action design</a> and <a href="https://index.ros.org/doc/ros2/Tutorials/Understanding-ROS2-Actions/">ROS2 action tutorial</a>. Our focus for this exercise will be to leverage ROS2 actions for Navigation2. For us to continue with the exercise, we need to understand one more concept: Behaviour Trees</p> <h3 id="behaviour-trees"> <a href="#behaviour-trees" class="anchor-head"></a> Behaviour Trees </h3> <p>Navigation2 documentation explains behaviour trees the best, so I am just going to link it here. But in essence, it splits the whole operation of a robot into smaller behaviours in a specific structure governed by rules. For example, if we want to have a robot to play football, we can split it in different primitives such as run to the ball, dribble, shoot and these states are further divided into sub primitives. How we can change from one behaviour to another is also dependant on rules and what conditions are satisfied.</p> <p>Navigation 2 uses <a href="https://www.behaviortree.dev/">BehaviorTree</a> CPP V3 as the behaviour tree library and we can use the trees created for navigation2 as subtrees of other trees. We create node plugins which can be constructed into a tree, inside the <code class="highlighter-rouge">BT Navigator</code>. The node plugins are loaded into the BT and when the XML file of the tree is parsed, the registered names are associated.</p> <h3 id="planning-and-controlling"> <a href="#planning-and-controlling" class="anchor-head"></a> Planning and Controlling </h3> <p>Two components of navigation are planning a path and executing the motion. Traditionally, these were handled using respective planning and control servers in ROS1. They make information such as costmaps and parameters available to all the other ROS nodes. In ROS2, they are represented as plugins.</p> <p>We will keep exploring the navigation2 stack in upcoming blogs so we can program our own plugins and nodes for our own logic. For multirobot exercise, this will be controlling the co-operation between the robots. But for now, let’s see how we can run the exercise.</p> <h2 id="launching-the-exercise"> <a href="#launching-the-exercise" class="anchor-head"></a> Launching the exercise </h2> <ol> <li>Install ROS2 foxy by following <a href="https://index.ros.org/doc/ros2/Installation/Foxy/">this</a> guide.</li> <li> <p>Pull the latest <a href="https://navigation.ros.org/build_instructions/index.html">Navigation2</a> and install it.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> git clone https://github.com/ros-planning/navigation2.git

 <span class="nb">cd </span>navigation2 

 <span class="nb">source</span> /opt/ros/foxy/setup.sh

 colcon build

 <span class="nb">.</span> ./install/setup.sh

 <span class="nb">export </span><span class="nv">TURTLEBOT3_MODEL</span><span class="o">=</span>waffle
</code></pre></div> </div> </li> <li> <p>Pull CustomRobots repo and build amazon_robot</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git pull https://github.com/shreyasgokhale/CustomRobots.git
<span class="nb">cd </span>CustomRobots/amazon_robot

colcon build

<span class="nb">.</span> ./install/setup.sh
</code></pre></div> </div> </li> <li> <p>Pull latest of my colab repo</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> git pull https://github.com/TheRoboticsClub/colab-gsoc2020-Shreyas_Gokhale.git
</code></pre></div> </div> </li> <li> <p><strong>Export the paths of models to let gazebo know from where to load them.</strong> In my case, this was the path</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">echo</span> <span class="s1">'export GAZEBO_MODEL_PATH=$GAZEBO_MODEL_PATH:~/CustomRobots/amazon_robot/amazon_robot_gazebo/models'</span> <span class="o">&gt;&gt;</span> ~/.bashrc

</code></pre></div> </div> </li> <li> <p>Launch the exercise</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd</span> ~/colab-gsoc2020-Shreyas_Gokhale/exercises/ros2/amazon_warehouse/launch

 ros2 launch ros2 launch amazon_warehouse_world.py

</code></pre></div> </div> </li> <li> <p>In another terminal, launch the solution</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd</span> ~/colab-gsoc2020-Shreyas_Gokhale/exercises/ros2/amazon_warehouse/

 python3 amazonWarehouse.py amazonMap.conf amazonConf.yml

</code></pre></div> </div> </li> <li>Success!</li> </ol> <div class="embed-container"> <iframe src="https://www.youtube.com/embed/QtHRuF0IS8E" width="700" height="480" frameborder="0" allowfullscreen=""> </iframe> </div> <p>Feel free to explore the exercise. You can right do almost everything except loading the pallet. The prismatic joint is still not working. I have raised the issue on both gazebo and ros forums and also contacted the developers of gazebo. Hopefully, this will get solved soon. Our next stop will be to introduce multi robot dynamics into the picture!</p> <p><strong><em>Na razie!</em></strong></p> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/colab-gsoc2020-Shreyas_Gokhale/phase-two-report" > <div class="nav-arrow">Previous</div> <span class="post-title">Evaluation 2 Report</span> </a> <a class="post-nav-item post-nav-next" href="/colab-gsoc2020-Shreyas_Gokhale/two-x"> <div class="nav-arrow">Next</div> <span class="post-title">2x !</span> </a> </nav> </div> <footer class="footer"> <a class="footer_item" href="https://github.com/shreyasgokhale">github</a> <a class="footer_item" href="https://www.linkedin.com/in/shreyas6gokhale/">linkedin</a> <a class="footer_item" href="https://www.instagram.com/elementaryshr/">instagram</a> <a class="footer_item" href="https://shreyasgokhale.com/">blog</a> <a class="footer_item" href="https://www.shreyasgokhaleresu.me/">portfolio</a> <a class="footer_item" href="/feed.xml">rss</a> <span class="footer_item">&copy; 2020</span> <small class="footer_theme-copyright"> <!-- Klisé Theme: https://github.com/piharpi/jekyll-klise --> <a href="https://jekyllrb.com" target="_blank" rel="noreferrer noopener" >jekyll</a> <a href="https://github.com/piharpi/jekyll-klise" target="_blank" rel="noreferrer noopener" >klisé</a> theme | modified by <a href="https://shreyasgokhale.com/" target="_blank" rel="noreferrer noopener" >shreyas</a> </small> </footer> <script src="/colab-gsoc2020-Shreyas_Gokhale/assets/js/main.js" defer="defer"></script> <script src="/colab-gsoc2020-Shreyas_Gokhale/assets/js/galite.js"></script> <script> var galite = galite || {}; galite.UA = "UA-126403543-4"; </script> </body> </html>
